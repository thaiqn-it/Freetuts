<!DOCTYPE html>
<!-- main-fragment(title, styles, body, scripts) -->
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{admin/layout/main-layout :: main-fragment(
                                                ~{::title},
                                                ~{:: #styles},
                                                ~{::body},
                                                ~{:: #scripts},
                                               )}">

<head>
    <title>Freetuts - Admin</title>
</head>

<body>
<ul class="nav my-2">
    <li class="nav-item"><h4 class="card-title">Posts</h4></li>
    <li class="nav-item ml-auto">
        <!-- +new -->
        <a class="btn btn-primary text-white rounded-circle font-13"
           href="#"> <i class="fas fa-plus"></i> </a>
    </li>
</ul>

<div class="table-responsive">
    <table id="multi_col_order"
           class="table table-striped table-bordered display">
        <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Creator Name</th>
            <th>(ID) Category Name</th>
            <th>Created Date</th>
            <th>Available</th>
            <th>Edit</th>
        </tr>
        </thead>
        <tfoot>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Creator Name</th>
            <th>(ID) Category Name</th>
            <th>Created Date</th>
            <th>Available</th>
            <th>Edit</th>
        </tr>
        </tfoot>
        <tbody>
        <tr th:each="post : ${posts}">
            <td> <span th:text="${post.id}">Id</span> 
          	<a href="#" data-toggle="modal" data-target="#modalPreview" th:onclick="preview(this.id,this.name)"
          	 th:id="'('+${post.id}+') '+${post.name}" th:name="'/contents/' + ${post.contentFile}"> <i class="far fa-eye">
          	 </i></a></td>
            <td th:text="${post.name}">Name</td>
            <td th:text="${post.creatorName}">CreatorName</td>
            <td th:text="'(' + ${post.categoryId} + ') ' + ${post.categoryName}">CategoryName</td>
            <th th:text="${#dates.format(post.createdDate, 'dd-MM-yyyy')}">CreatedDate</th>
            <td style="text-align: center;">
                <a th:if="${post.available == true}"
                   class="btn btn-success"
                   href="#"
                   data-toggle="modal"
                   data-target="#modalStatus"
                   th:onclick="'updateStatus(this.id,this.name,'+${post.available}+')'"
                   th:id="'('+${post.id}+') '+${post.name}" th:name="'/admin/post/' + ${post.id} + '/' + ${!post.available}" 
                   style="width: 40px; height: 40px;">
                    <i class="fas fa-check"></i>
                </a>
                <a th:if="${post.available == false}"
                   class="btn btn-danger"
                   href="#"
                   data-toggle="modal"
                   data-target="#modalStatus"
                   th:onclick="'updateStatus(this.id,this.name,'+${post.available}+')'"
                   th:id="'('+${post.id}+') '+${post.name}" th:name="'/admin/post/' + ${post.id} + '/' + ${!post.available}" 
                   style="width: 40px; height: 40px;">
                    <i class="fas fa-times"></i>
                </a>
            </td>

            <td style="text-align: center;">
                <a class="btn btn-primary"
                   href="javascript:void(0)"
                   style="width: 40px; height: 40px;">
                    <i class="far fa-edit"></i>
                </a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<th:block th:replace="/admin/common/___modal :: updateModal"></th:block>

    <!-- UpdateStatus -->
	<script type="text/javascript" th:src="@{/dist/js/admin-updateStatus.js}"></script>
	<!-- ./UpdateStatus -->
	
	<!-- Preview -->
	<script>
	function preview(title,file_url){
		$("#preview_title").html(title);
		includeHTML(file_url);
	};
	
			function includeHTML(file_url) {
			  var z, i, elmnt, file, xhttp;
			  /* Loop through a collection of all HTML elements: */
			  z = $("#preview_content");
			  for (i = 0; i < z.length; i++) {
			    elmnt = z[i];
			    elmnt.innerHTML = "";
			    /*search for elements with a certain atrribute:*/
			    file = file_url;
			    if (file) {
			      /* Make an HTTP request using the attribute value as the file name: */
			      xhttp = new XMLHttpRequest();
			      xhttp.onreadystatechange = function() {
			        if (this.readyState == 4) {
			          if (this.status == 200) {elmnt.innerHTML = this.responseText;}
			          if (this.status == 404) {elmnt.innerHTML = "Page not found.";}
			        }
			      }
			      xhttp.open("GET", file, true);
			      xhttp.send();
			      /* Exit the function: */
			      return;
			    }
			  }
			};
		</script>
	<!-- ./Preview -->
</body>

</html>